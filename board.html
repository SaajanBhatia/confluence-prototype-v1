<!--
    Code written by Kian Doyle and Saajan Bhatia
-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kanban Board</title>

    <!--Bootstrap CSS CDN-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">

    <!--Bootstrap Icons CDN-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">

    <!--Google Fonts CDN-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Varela+Round&display=swap" rel="stylesheet">

    <!--jQuery CDN-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <!--Custom Styling-->
    <!-- Custom CSS -->
    <link rel="stylesheet" href="./style.css">
    <style>

        .card.draggable {
            margin-bottom: 1rem;
            cursor: grab;
        }

        .droppable {
            background-color: var(--success);
            min-height: 120px;
            margin-bottom: 1rem;
        }

        /* Scroll the kanban board */
        .x-scroller {
            overflow-x: scroll;
            overflow-y:hidden;
            width: 100%;
        }

        /* Custom Scrollbar since the normal one looks clapped */
        ::-webkit-scrollbar {
            width: 12px;
        }
        

        ::-webkit-scrollbar-thumb {
            border-radius: 10px;
            background-color: grey;
            -webkit-box-shadow: inset 0 0 6px rgba(90,90,90,0.7);
        }
        ::-webkit-scrollbar-thumb:hover{
            opacity: 10%;
        }
        
        a {
            color: white;
            text-decoration: none; /* no underline */
        }

        h {
            color: purple;
            font-family: 'Varela Round', sans-serif;
            font-size: 14px;
        }

        span {
            font-size: 75px;
        }

        #span1 {
            font-size: 30px;
        }

        i {
            font-size: 30px;
        }
        
    </style>
</head>
<body>
    <div class="container">
        <!-- Navbar -->
        <div class="row custom-nav">
            <div class="col m-4">
                <nav class="navbar navbar-expand-sm">
                    <div class="container">
                        <a class="navbar-brand custom-h1" href="/">
                            <img src="./images/logo.png" alt="" style="width: 15rem">
                        </a>
                        <button class="navbar-toggler" type="button" data-toggle="collapse"
                            data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                            aria-label="Toggle navigation">
                            <span class="navbar-toggler-icon"></span>
                        </button>
        
                        <div class="collapse navbar-collapse" id="navbarSupportedContent">
                            <ul class=" nav navbar-nav navbar-center custom-ul mt-3">
                                <li class="nav-item">
                                    <a class="nav-link" href="./manager-dash.html">
                                        Dashboard
                                    </a>
                                </li>
                                <li class="nav-item custom-active">
                                    <a class="nav-link custom-active" href="./board.html">
                                        Board
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="./articles.html">
                                        Knowledge
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="./topics.html">
                                        Topics
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="./account.html">
                                        Account
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="./sign-in.html">
                                        Exit <i class="bi bi-box-arrow-right mx-1" style="font-size: 1rem; color: grey;"></i>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </nav>
            </div>
        </div>

        <!--Page Content-->

        <div class="container-fluid">
            <div class="row">
                <hr>
                <div class="col-1 text-white" style="padding: 7px;">
                    Board
                </div>
                <div class="col-2">
                    <div class="dropdown">
                        <a class="btn dropdown-toggle" role="button" data-bs-toggle="dropdown" aria-expanded="false"
                            style="color: white;">
                            Project Name
                        </a>
                        <ul class="dropdown-menu dropdown-menu-dark">
                            <li><a class="dropdown-item active" href="#">Project 2</a></li>
                            <li><a class="dropdown-item" href="#">Project 3</a></li>
                            <li><a class="dropdown-item" href="#">Project 4</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-7"></div>
                <div class="col-2 text-white" style="text-align: end;">
                    <div class="input-group mb-3">
                        <span class="input-group-text bg-dark text-white border-dark" id="basic-addon1">Lead</span>
                        <input type="text" class="form-control bg-dark text-white border-dark" placeholder="Saajan Bhatia" aria-label="Username"
                            aria-describedby="basic-addon1" readonly>
                    </div>
                </div>
            </div>

            <!--Analytics-->
            <div class="row">
                
                <div class="col">
                    <div class="card text-bg-dark" style="max-width: 18rem; margin-top: 5vh; margin-left: 5vw; height: fit-content; min-height: 7.5rem;">
                        <div class="card-body" style="padding-block: 0;">
                            <div class="row" style="align-items: center;">
                                <div class="col">
                                    <i class="bi bi-calendar-check"></i>
                                    <p>DEADLINE</p> 
                                </div>
                                <div class="col">
                                    <h><span>17</span>Dec</h>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col">
                    <div class="card text-bg-dark" style="max-width: 18rem; margin-top: 5vh; margin-left: 5vw; min-height: 7.5rem;">
                        <div class="card-body" style="padding-block: 0;">
                            <div class="row" style="align-items: center;">
                                <div class="col">
                                    <i class="bi bi-hourglass-split"></i>
                                    <p>HOURS LEFT</p> 
                                </div>
                                <div class="col">
                                    <h><span>17</span>Hrs</h>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col">
                    <div class="card text-bg-dark" style="max-width: 18rem; margin-top: 5vh; margin-left: 5vw; min-height: 7.5rem;">
                        <div class="card-body" style="padding-block: 0;">
                            <div class="row mt-3" style="align-items: center; height: 100%;">
                                <div class="col">
                                    <i class="bi bi-person"></i>
                                    <p>CLIENT</p> 
                                </div>
                                <div class="col-8" style="padding: 0; margin: 0;">
                                    <h id="span1">Adidas AG</h>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            
            </div>

            <!--New Kanban Board-->
            <div class="row p-2 mb-5 mt-5">
                <div class="container-fluid pt-3 text-black">
                    <div class="row">
                        <h3 class="font-weight-light text-white text-center">Board</h3>
                        <div class="text-light text-center">Drag and drop between swim lanes</div>
                        <div class="row flex-row flex-sm-nowrap py-3 x-scroller" id="laneScroller">
                            <div class="col-sm-6 col-md-4 col-xl-3">
                                <div class="card bg-dark">
                                    <div class="card-body">
                                        <h6 class="card-title text-uppercase text-truncate py-2 text-white">To Do</h6>
                                        <div class="items border border-dark">
                                            <div class="card draggable shadow-sm bg-secondary bg-secondary" id="cd1"
                                                draggable="true" ondragstart="drag(event)">
                                                <div class="card-body p-2">
                                                    <div class="card-title">
                                                        <img src="https://icons.iconarchive.com/icons/dtafalonso/android-lollipop/24/Photos-icon.png"
                                                            class="rounded-circle float-right">
                                                        <a href="" class="lead font-weight-light">TSK-154</a>
                                                    </div>
                                                    <p>
                                                        This is a description of a item on the board.
                                                    </p>
                                                    <button class="btn btn-primary btn-sm">View</button>
                                                </div>
                                            </div>
                                            <div class="dropzone rounded" ondrop="drop(event)" ondragover="allowDrop(event)"
                                                ondragleave="clearDrop(event)"> &nbsp; </div>
                                            <div class="card draggable shadow-sm bg-secondary" id="cd2" draggable="true"
                                                ondragstart="drag(event)">
                                                <div class="card-body p-2">
                                                    <div class="card-title">
                                                        <img src="https://icons.iconarchive.com/icons/dtafalonso/android-lollipop/24/Photos-icon.png"
                                                            class="rounded-circle float-right">
                                                        <a href="" class="lead font-weight-light">TSK-156</a>
                                                    </div>
                                                    <p>
                                                        This is a description of a item on the board.
                                                    </p>
                                                    <button class="btn btn-primary btn-sm">View</button>
                                                </div>
                                            </div>
                                            <div class="dropzone rounded" ondrop="drop(event)" ondragover="allowDrop(event)"
                                                ondragleave="clearDrop(event)"> &nbsp; </div>
                                            <div class="card draggable shadow-sm bg-secondary" id="cd3" draggable="true"
                                                ondragstart="drag(event)">
                                                <div class="card-body p-2">
                                                    <div class="card-title">
                                                        <img src="https://icons.iconarchive.com/icons/dtafalonso/android-lollipop/24/Photos-icon.png"
                                                            class="rounded-circle float-right">
                                                        <a href="" class="lead font-weight-light">TSK-157</a>
                                                    </div>
                                                    <p>
                                                        This is an item on the board. There is some descriptive text that explains
                                                        the item
                                                        here.
                                                    </p>
                                                    <button class="btn btn-primary btn-sm">View</button>
                                                </div>
                                            </div>
                                            <div class="dropzone rounded" ondrop="drop(event)" ondragover="allowDrop(event)"
                                                ondragleave="clearDrop(event)"> &nbsp; </div>
            
                                        </div>
                                        <div>
                                            <button class="btn btn-outline-light" data-bs-toggle="modal" data-bs-target="#newTaskModal">✏️ Add Task</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6 col-md-4 col-xl-3">
                                <div class="card bg-dark">
                                    <div class="card-body">
                                        <h6 class="card-title text-uppercase text-truncate py-2 text-light">In-progess</h6>
                                        <div class="items border border-dark">
                                            <div class="card draggable shadow-sm bg-secondary" id="cd1" draggable="true"
                                                ondragstart="drag(event)">
                                                <div class="card-body p-2">
                                                    <div class="card-title">
                                                        <img src="https://icons.iconarchive.com/icons/dtafalonso/android-lollipop/24/Photos-icon.png"
                                                            class="rounded-circle float-right">
                                                        <a href="" class="lead font-weight-light">TSK-152</a>
                                                    </div>
                                                    <p>
                                                        This is a task that is being worked on.
                                                    </p>
                                                    <button class="btn btn-primary btn-sm">View</button>
                                                </div>
                                            </div>
                                            <div class="dropzone rounded" ondrop="drop(event)" ondragover="allowDrop(event)"
                                                ondragleave="clearDrop(event)"> &nbsp; </div>
                                            <div class="card draggable shadow-sm bg-secondary" id="cd2" draggable="true"
                                                ondragstart="drag(event)">
                                                <div class="card-body p-2">
                                                    <div class="card-title">
                                                        <img src="https://icons.iconarchive.com/icons/dtafalonso/android-lollipop/24/Photos-icon.png"
                                                            class="rounded-circle float-right">
                                                        <a href="" class="lead font-weight-light">TSK-153</a>
                                                    </div>
                                                    <p>
                                                        Another task here that is in progress.
                                                    </p>
                                                    <button class="btn btn-primary btn-sm">View</button>
                                                </div>
                                            </div>
                                            <div class="dropzone rounded" ondrop="drop(event)" ondragover="allowDrop(event)"
                                                ondragleave="clearDrop(event)"> &nbsp;
                                            </div>
                                        </div>
                                        <div>
                                            <button class="btn btn-outline-light" data-bs-toggle="modal" data-bs-target="#newTaskModal">✏️ Add Task</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6 col-md-4 col-xl-3">
                                <div class="card bg-dark">
                                    <div class="card-body">
                                        <h6 class="card-title text-uppercase text-truncate py-2 text-white">Review</h6>
                                        <div class="items border border-dark">
                                            <div class="card draggable shadow-sm bg-secondary" id="cd9" draggable="true"
                                                ondragstart="drag(event)">
                                                <div class="card-body p-2">
                                                    <div class="card-title">
                                                        <img src="https://icons.iconarchive.com/icons/dtafalonso/android-lollipop/24/Photos-icon.png"
                                                            class="rounded-circle float-right">
                                                        <a href="" class="lead font-weight-light">TSK-158</a>
                                                    </div>
                                                    <p>
                                                        This is a description of a item on the board.
                                                    </p>
                                                    <button class="btn btn-primary btn-sm">View</button>
                                                </div>
                                            </div>
                                            <div class="dropzone rounded" ondrop="drop(event)" ondragover="allowDrop(event)"
                                                ondragleave="clearDrop(event)"> &nbsp; </div>
                                        </div>
                                        <div>
                                            <button class="btn btn-outline-light" data-bs-toggle="modal" data-bs-target="#newTaskModal">✏️ Add Task</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6 col-md-4 col-xl-3">
                                <div class="card bg-dark">
                                    <div class="card-body">
                                        <h6 class="card-title text-uppercase text-truncate py-2 text-white">Complete</h6>
                                        <div class="items border border-dark">
                                            <div class="card draggable shadow-sm bg-secondary" id="cd11" draggable="true"
                                                ondragstart="drag(event)">
                                                <div class="card-body p-2">
                                                    <div class="card-title">
                                                        <img src="https://icons.iconarchive.com/icons/dtafalonso/android-lollipop/24/Photos-icon.png"
                                                            class="rounded-circle float-right">
                                                        <a href="" class="lead font-weight-light">TSK-144</a>
                                                    </div>
                                                    <p>
                                                        This is a description of an item.
                                                    </p>
                                                    <button class="btn btn-primary btn-sm">View</button>
                                                </div>
                                            </div>
                                            <div class="dropzone rounded" ondrop="drop(event)" ondragover="allowDrop(event)"
                                                ondragleave="clearDrop(event)"> &nbsp; </div>
                                            <div class="card draggable shadow-sm bg-secondary" id="cd12" draggable="true"
                                                ondragstart="drag(event)">
                                                <div class="card-body p-2">
                                                    <div class="card-title">
                                                        <img src="https://icons.iconarchive.com/icons/dtafalonso/android-lollipop/24/Photos-icon.png"
                                                            class="rounded-circle float-right">
                                                        <a href="" class="lead font-weight-light">TSK-146</a>
                                                    </div>
                                                    <p>
                                                        This is a description of a task item.
                                                    </p>
                                                    <button class="btn btn-primary btn-sm">View</button>
                                                </div>
                                            </div>
                                            <div class="dropzone rounded" ondrop="drop(event)" ondragover="allowDrop(event)"
                                                ondragleave="clearDrop(event)"> &nbsp; </div>
                                        </div>
                                        <div>
                                            <button class="btn btn-outline-light" data-bs-toggle="modal" data-bs-target="#newTaskModal">✏️ Add Task</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6 col-md-4 col-xl-3">
                                <div class="card bg-dark">
                                    <div class="card-body">
                                        <h6 class="card-title text-uppercase text-truncate py-2 text-light">
                                            <button class="btn btn-outline-danger" data-bs-toggle="modal"
                                                data-bs-target="#newLaneModal">
                                                + Add New Lane
                                            </button>
                                        </h6>
                                        <div class="items border border-dark">
            
                                            <div class="dropzone rounded" ondrop="drop(event)" ondragover="allowDrop(event)"
                                                ondragleave="clearDrop(event)"> &nbsp; </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modals -->

        <!-- New Lane Modal -->
        <div class="modal fade" id="newLaneModal" tabindex="-1" aria-labelledby="New Lane Modal" aria-hidden="true">
            <div class="modal-dialog">
            <div class="modal-content bg-dark text-white">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Create New Lane</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <input type="text" class="form-control" id="laneName" name="laneName" placeholder="Name your new lane" aria-label="Lane Name">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal" onclick="createNewLane(name)" type="submit">Save changes</button>
                </div>
            </div>
            </div>
        </div>

        <!-- New Task Modal -->
        <div class="modal fade" id="newTaskModal" tabindex="-1" aria-labelledby="Task Modal" aria-hidden="true">
            <div class="modal-dialog">
            <div class="modal-content bg-dark text-white">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Create New Task</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <input type="text" class="form-control mb-3" id="taskID" name="taskID" placeholder="Task ID" aria-label="Task ID">
                    <input type="textfield" class="form-control mb-3" id="taskDescription" name="taskDescription" placeholder="A description of your task" aria-label="Task Description">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal" onclick="createTask(event)" type="submit">Save changes</button>
                </div>
            </div>
            </div>
        </div>

        <!-- Bootstrap JS -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>

        <script>
            //create task with custom name and description
            function createTask(event) {
                var taskName = document.getElementById("taskID").value;
                var taskDescription = document.getElementById("taskDescription").value;
                var taskHTML = '<div class="card draggable shadow-sm bg-secondary" id="cd12" draggable="true" ondragstart="drag(event)"><div class="card-body p-2"><div class="card-title"><img src="https://icons.iconarchive.com/icons/dtafalonso/android-lollipop/24/Photos-icon.png"class="rounded-circle float-right"><a href="" class="lead font-weight-light">'+ taskName +'</a></div><p>'+ taskDescription +'</p><button class="btn btn-primary btn-sm">View</button></div></div><div class="dropzone rounded" ondrop="drop(event)" ondragover="allowDrop(event)"ondragleave="clearDrop(event)"> &nbsp; </div>';    
                //this is a hardcode for example purposes 
                var taskHolders = document.getElementsByClassName('items border border-dark');
                var dropzones = taskHolders[0].getElementsByClassName('dropzone rounded');
                dropzones[dropzones.length-1].insertAdjacentHTML('afterend', taskHTML);
            }

            //create lane with custom name      
            function createNewLane(event) {
                var laneName = document.getElementById("laneName").value;
                var laneHTML = '<div class="col-sm-6 col-md-4 col-xl-3"><div class="card bg-dark"><div class="card-body"><h6 class="card-title text-uppercase text-truncate py-2 text-white">' + laneName + '</h6><div class="items border border-dark"><div class="dropzone rounded" ondrop="drop(event)" ondragover="allowDrop(event)"ondragleave="clearDrop(event)"> &nbsp; </div><div><button class="btn btn-outline-light">✏️ Add Task</button></div></div></div></div></div>';
                var lists = document.getElementsByClassName("col-sm-6 col-md-4 col-xl-3");
                lists[lists.length-2].insertAdjacentHTML('afterend', laneHTML);
            }

            const drag = (event) => {
            event.dataTransfer.setData("text/plain", event.target.id);
            }

            const allowDrop = (ev) => {
            ev.preventDefault();
            if (hasClass(ev.target,"dropzone")) {
                addClass(ev.target,"droppable");
            }
            }

            const clearDrop = (ev) => {
                removeClass(ev.target,"droppable");
            }

            const drop = (event) => {
            event.preventDefault();
            const data = event.dataTransfer.getData("text/plain");
            const element = document.querySelector(`#${data}`);
            try {
                // remove the spacer content from dropzone
                event.target.removeChild(event.target.firstChild);
                // add the draggable content
                event.target.appendChild(element);
                // remove the dropzone parent
                unwrap(event.target);
            } catch (error) {
                console.warn("can't move the item to the same place")
            }
            updateDropzones();
            }

            const updateDropzones = () => {
                /* after dropping, refresh the drop target areas
                so there is a dropzone after each item
                using jQuery here for simplicity */
                
                var dz = $('<div class="dropzone rounded" ondrop="drop(event)" ondragover="allowDrop(event)" ondragleave="clearDrop(event)"> &nbsp; </div>');
                
                // delete old dropzones
                $('.dropzone').remove();

                // insert new dropdzone after each item   
                dz.insertAfter('.card.draggable');
                
                // insert new dropzone in any empty swimlanes
                $(".items:not(:has(.card.draggable))").append(dz);
            };

            // helpers
            function hasClass(target, className) {
                return new RegExp('(\\s|^)' + className + '(\\s|$)').test(target.className);
            }

            function addClass(ele,cls) {
            if (!hasClass(ele,cls)) ele.className += " "+cls;
            }

            function removeClass(ele,cls) {
            if (hasClass(ele,cls)) {
                var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
                ele.className=ele.className.replace(reg,' ');
            }
            }

            function unwrap(node) {
                node.replaceWith(...node.childNodes);
            }
        </script>
    </div>
</body>
</html>